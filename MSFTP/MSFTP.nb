(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     10079,        354]
NotebookOptionsPosition[      7770,        268]
NotebookOutlinePosition[      8493,        296]
CellTagsIndexPosition[      8409,        291]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrependTo", "[", 
    RowBox[{"$Path", ",", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}]}], 
    "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "this", " ", "notebook", " ", "is", " ", "called", " ", "from", 
    " ", "workbench"}], " ", "*)"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NotebookDirectory", "[", "]"}]], "Input"],

Cell[BoxData["\<\"C:\\\\repositorygit\\\\MSFTP\\\\MSFTP\\\\\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Install MSFTP, if needed.
Load it\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindFile", "[", "\"\<MSFTP`\>\"", "]"}]], "Input"],

Cell[BoxData["\<\"C:\\\\repositorygit\\\\MSFTP\\\\MSFTP\\\\Kernel\\\\init.m\"\
\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FindFile", "[", "\"\<MSFTP`\>\"", "]"}], "===", "$Failed"}], ",",
    " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "\[GreaterEqual]", "9"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Get", "@", "\"\<http://goo.gl/Ncbbi6\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Import", "@", 
       "\"\<https://raw.githubusercontent.com/rolfmertig/\
MathematicaPackageInstall/master/MathematicaPackageInstall/\
MathematicaPackageInstall.m\>\""}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Setting", " ", "\[IndentingNewLine]", 
        "MathematicaPackageInstall`$AutomaticInstall"}], " ", "=", " ", 
       "True"}], ";", "   ", "\[IndentingNewLine]", "  ", 
      RowBox[{
      "here", " ", "would", " ", "also", " ", "automatically", " ", "install",
        " ", "Unzip", " ", "and", " ", "CopyRemote", " ", "to", " ", 
       RowBox[{"$UserBase", "/", "Applications"}]}]}], " ", 
     "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "This", " ", "installs", " ", "the", " ", "package", " ", "MSFTP", " ", 
      "to", " ", 
      RowBox[{"$UserBase", "/", "Applications"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
    "MathematicaPackageInstall`MathematicaPackageInstall", "[", 
     "\"\<MSFTP\>\"", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<MSFTP`\>\"", "]"}]], "Input"],

Cell["\<\
Uninstall by executing:
Get@\[CloseCurlyDoubleQuote]http://goo.gl/Ncbbi6\[CloseCurlyDoubleQuote];
MathematicaPackageInstall`MathematicaPackageUninstall[\"MSFTP\"] 
\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inspect package", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<MSFTP`*\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"MSFTPGet\"\>", ",", "\<\"MSFTPPut\"\>", 
   ",", "\<\"PassEncode\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MSFTPPut"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"MSFTPPut[fileordirectory, \\\"UserName\\\" -> \\\"rolfm\\\", \
\\\"HostName\\\" -> \\\"sftpserver.mycompany.com\\\", \\n\\\"Password\\\"->\\\
\"secret\\\"] uploads fileordirectory. MSFTPPut[fileordir, remotedir] uploads \
to remotedir.\\nThe password can be either given in clear text, or as a list \
of integers as returned by PassEncode[\\\"mypassword\\\"].\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellTags->"Info3639215303-1742248"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MSFTPGet"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"MSFTPGet[remotefile, localdir] transfers remotefile to \
localdir.\"\>", "MSG"]], "Print", "PrintUsage",
 CellTags->"Info3639215303-1742248"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "PassEncode"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"PassEncode[secret] encodes the password secret for the \
$MachineID of the current computer. \\nThe resulting list can be given as an \
encoded password setting for the option Password of MSFTPPut and \
MSFTPGet.\"\>", "MSG"]], "Print", "PrintUsage",
 CellTags->"Info3639215303-1742248"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "@", "MSFTPPut"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"HostName\"\>", "\[Rule]", "\<\"www.gluonvision.de\"\>"}], ",", 
   RowBox[{"\<\"Password\"\>", "\[Rule]", "\<\"secret\"\>"}], ",", 
   RowBox[{"\<\"Port\"\>", "\[Rule]", "22"}], ",", 
   RowBox[{"\<\"UserName\"\>", "\[RuleDelayed]", "$UserName"}], ",", 
   RowBox[{"Print", "\[Rule]", "False"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Tests \nchange ",
 StyleBox["$mypassword",
  FontWeight->"Bold"],
 " (and eventyally $myusername)"
}], "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$myUserName", " ", "=", " ", "$UserName"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$myPassword", " ", "=", " ", "\"\<verysecret\>\""}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"#", ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<HostName\>\"", " ", "\[Rule]", " ", 
       "\"\<www.gluonvision.com\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<UserName\>\"", " ", "\[Rule]", " ", "$myUserName"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Password\>\"", " ", "\[Rule]", "$myPassword"}]}], 
     "\[IndentingNewLine]", "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"{", 
    RowBox[{"MSFTPGet", ",", "MSFTPPut"}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Create a remote directory (test)  and upload a file to it", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MSFTPPut", "[", 
  RowBox[{
   RowBox[{"ToFileName", "[", 
    RowBox[{"\"\<FileName\>\"", " ", "/.", " ", 
     RowBox[{"NotebookInformation", "[", 
      RowBox[{"InputNotebook", "[", "]"}], "]"}]}], "]"}], ",", " ", 
   "\"\<test\>\""}], "]"}]], "Input"],

Cell[BoxData["\<\"C:\\\\repositorygit\\\\MSFTP\\\\MSFTP\\\\MSFTP.nb\"\>"], \
"Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Get a remote directory (test)  and save it to \
FileNameJoin[{$TemporaryDirectory,\[CloseCurlyDoubleQuote]test\
\[CloseCurlyDoubleQuote]}]\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "@", 
  RowBox[{"MSFTPGet", "[", 
   RowBox[{"\"\<test\>\"", ",", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$TemporaryDirectory", ",", "\"\<test\>\""}], "}"}], "]"}], ",", 
    RowBox[{"Print", "\[Rule]", "False"}]}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Put a directory with all its content in a directory \
\[OpenCurlyDoubleQuote]MSFTP\[CloseCurlyDoubleQuote] on the server:\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{"AbsoluteTiming", " ", "@", " ", 
  RowBox[{"MSFTPPut", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], " ", "//", " ", 
     "ParentDirectory"}], ",", " ", "\"\<MSFTP\>\""}], "]"}]}]], "Input"]
}, Open  ]]
}, Open  ]]
},
Editable->True,
WindowSize->{1106, 860},
WindowMargins->{{229, Automatic}, {40, Automatic}},
ShowSelection->True,
Magnification:>1.55 Inherited,
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3639215303-1742248"->{
  Cell[3694, 130, 466, 7, 123, "Print",
   CellTags->"Info3639215303-1742248"],
  Cell[4251, 145, 170, 3, 64, "Print",
   CellTags->"Info3639215303-1742248"],
  Cell[4514, 156, 316, 5, 94, "Print",
   CellTags->"Info3639215303-1742248"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3639215303-1742248", 8147, 281}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 368, 11, 77, "Input"],
Cell[CellGroupData[{
Cell[950, 35, 65, 1, 46, "Input"],
Cell[1018, 38, 76, 0, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1131, 43, 60, 3, 175, "Section"],
Cell[CellGroupData[{
Cell[1216, 50, 74, 1, 46, "Input"],
Cell[1293, 53, 94, 1, 45, "Output"]
}, Open  ]],
Cell[1402, 57, 1631, 40, 526, "Input"],
Cell[3036, 99, 71, 1, 46, "Input"],
Cell[3110, 102, 188, 5, 135, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3335, 112, 34, 0, 110, "Section"],
Cell[CellGroupData[{
Cell[3394, 116, 72, 1, 46, "Input"],
Cell[3469, 119, 134, 3, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3640, 127, 51, 1, 46, "Input"],
Cell[3694, 130, 466, 7, 123, "Print",
 CellTags->"Info3639215303-1742248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4197, 142, 51, 1, 46, "Input"],
Cell[4251, 145, 170, 3, 64, "Print",
 CellTags->"Info3639215303-1742248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4458, 153, 53, 1, 46, "Input"],
Cell[4514, 156, 316, 5, 94, "Print",
 CellTags->"Info3639215303-1742248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4867, 166, 62, 1, 46, "Input"],
Cell[4932, 169, 371, 7, 74, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5352, 182, 131, 5, 172, "Section"],
Cell[5486, 189, 208, 6, 76, "Input"],
Cell[5697, 197, 580, 14, 163, "Input"],
Cell[CellGroupData[{
Cell[6302, 215, 79, 0, 75, "Subsection"],
Cell[CellGroupData[{
Cell[6406, 219, 281, 7, 76, "Input"],
Cell[6690, 228, 86, 1, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6825, 235, 168, 4, 121, "Subsection"],
Cell[6996, 241, 304, 7, 76, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7337, 253, 151, 3, 75, "Subsection"],
Cell[7491, 258, 251, 6, 46, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
