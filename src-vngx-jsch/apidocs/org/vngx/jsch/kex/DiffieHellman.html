<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_45) on Mon May 18 17:42:10 CEST 2015 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DiffieHellman (vngx-jsch 0.10 API)</title>
<meta name="date" content="2015-05-18">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DiffieHellman (vngx-jsch 0.10 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DiffieHellman.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/vngx/jsch/kex/DHGroupKexAlgorithm.html" title="class in org.vngx.jsch.kex"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/vngx/jsch/kex/DiffieHellmanImpl.html" title="class in org.vngx.jsch.kex"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/vngx/jsch/kex/DiffieHellman.html" target="_top">Frames</a></li>
<li><a href="DiffieHellman.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.vngx.jsch.kex</div>
<h2 title="Interface DiffieHellman" class="title">Interface DiffieHellman</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><a href="../../../../org/vngx/jsch/algorithm/Algorithm.html" title="interface in org.vngx.jsch.algorithm">Algorithm</a></dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../org/vngx/jsch/kex/DiffieHellmanImpl.html" title="class in org.vngx.jsch.kex">DiffieHellmanImpl</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">DiffieHellman</span>
extends <a href="../../../../org/vngx/jsch/algorithm/Algorithm.html" title="interface in org.vngx.jsch.algorithm">Algorithm</a></pre>
<div class="block"><p>Interface to define a Diffie-Hellman (DH) key exchange. Diffieâ€“Hellman key
 exchange is a cryptographic protocol that allows two parties that have no
 prior knowledge of each other to jointly establish a shared secret key over
 an insecure communications channel. This key can then be used to encrypt
 subsequent communications using a symmetric key cipher. It is a type of key
 exchange.</p>

 <p>The Diffie-Hellman (DH) key exchange provides a shared secret that cannot
 be determined by either party alone.  The key exchange is combined with a
 signature with the host key to provide host authentication.  This key
 exchange method provides explicit server authentication.</p>

 <p>The following steps are used to exchange a key.  In this, C is the client;
 S is the server; p is a large safe prime; g is a generator for a subgroup of
 GF(p); q is the order of the subgroup; V_S is S's identification string;
 V_C is C's identification string; K_S is S's public host key; I_C is C's
 SSH_MSG_KEXINIT message and I_S is S's SSH_MSG_KEXINIT message that have been
 exchanged before this part begins.</p>

 <ol>
        <li>C generates a random number x (1 &lt; x &lt; q) and computes
                e = g^x mod p.  C sends e to S.</li>

        <li>S generates a random number y (0 &lt; y &lt; q) and computes
                f = g^y mod p.  S receives e.  It computes K = e^y mod p,
                H = hash(V_C || V_S || I_C || I_S || K_S || e || f || K)
                (these elements are encoded according to their types; see below), and
                signature s on H with its private host key.  S sends (K_S || f || s)
                to C.  The signing operation may involve a second hashing operation.</li>

        <li>C verifies that K_S really is the host key for S (e.g., using
                certificates or a local database).  C is also allowed to accept the key
                without verification; however, doing so will render the protocol
                insecure against active attacks (but may be desirable for practical
                reasons in the short term in many environments).  C then computes
                K = f^x mod p, H = hash(V_C || V_S || I_C || I_S || K_S || e || f || K),
                and verifies the signature s on H.</li>
 </ol>

 <p>Values of 'e' or 'f' that are not in the range [1, p-1] MUST NOT be sent
 or accepted by either side.  If this condition is violated, the key exchange
 fails.</p>

 <p>This is implemented with the following messages.  The hash algorithm for
 computing the exchange hash is defined by the method name, and is called
 HASH.  The public key algorithm for signing is negotiated with the
 SSH_MSG_KEXINIT messages.</p>

 <p>First, the client sends the following:</p>
 <pre>
                byte      SSH_MSG_KEXDH_INIT
                mpint     e
 </pre>

 <p>The server then responds with the following:</p>
 <pre>
                byte      SSH_MSG_KEXDH_REPLY
                string    server public host key and certificates (K_S)
                mpint     f
                string    signature of H
 </pre>

 <p>The hash H is computed as the HASH hash of the concatenation of the
 following:</p>
 <pre>
                string    V_C, the client's identification string (CR and LF excluded)
                string    V_S, the server's identification string (CR and LF excluded)
                string    I_C, the payload of the client's SSH_MSG_KEXINIT
                string    I_S, the payload of the server's SSH_MSG_KEXINIT
                string    K_S, the host key
                mpint     e, exchange value sent by the client
                mpint     f, exchange value sent by the server
                mpint     K, the shared secret
 </pre>

 <p>This value is called the exchange hash, and it is used to authenticate the
 key exchange.  The exchange hash SHOULD be kept secret.</p>

 <p>The signature algorithm MUST be applied over H, not the original data.
 Most signature algorithms include hashing and additional padding (e.g.,
 "ssh-dss" specifies SHA-1 hashing).  In that case, the data is first hashed
 with HASH to compute H, and H is then hashed with SHA-1 as part of the
 signing operation.</p>

 <p><a href="http://tools.ietf.org/html/rfc4253#section-7">RFC 4253 - The
 Secure Shell (SSH) Transport Layer Protocol: Diffie-Hellman Key Exchange</a>
 </p>

 <p><strong>Note:</strong> Instances should be created using the
 <code>AlgorithmManager</code> factory.</p></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Michael Laudati</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../org/vngx/jsch/algorithm/AlgorithmManager.html" title="class in org.vngx.jsch.algorithm"><code>AlgorithmManager</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/vngx/jsch/kex/DiffieHellman.html#getE--">getE</a></span>()</code>
<div class="block">Returns 'e' the exchange value sent from client calculated by
 e = g^x mod p (and x is a random number (1 &lt; x &lt; (p-1)/2))/</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/vngx/jsch/kex/DiffieHellman.html#getK--">getK</a></span>()</code>
<div class="block">Returns the shared secret key calculated by K = f^x mod p.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/vngx/jsch/kex/DiffieHellman.html#setF-byte:A-">setF</a></span>(byte[]&nbsp;f)</code>
<div class="block">Sets 'f' the exchange value sent by the server after receiving 'e'
 calculated by f = g^y mod p (and y (0 &lt; y &lt; q).</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/vngx/jsch/kex/DiffieHellman.html#setG-byte:A-">setG</a></span>(byte[]&nbsp;g)</code>
<div class="block">Sets the public base for D-H key exchange.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/vngx/jsch/kex/DiffieHellman.html#setP-byte:A-">setP</a></span>(byte[]&nbsp;p)</code>
<div class="block">Sets the public (prime) number for D-H key exchange.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setP-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setP</h4>
<pre>void&nbsp;setP(byte[]&nbsp;p)</pre>
<div class="block">Sets the public (prime) number for D-H key exchange.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>p</code> - public (prime) exchange</dd>
</dl>
</li>
</ul>
<a name="setG-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setG</h4>
<pre>void&nbsp;setG(byte[]&nbsp;g)</pre>
<div class="block">Sets the public base for D-H key exchange.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>g</code> - </dd>
</dl>
</li>
</ul>
<a name="getE--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getE</h4>
<pre>byte[]&nbsp;getE()
     throws <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<div class="block">Returns 'e' the exchange value sent from client calculated by
 e = g^x mod p (and x is a random number (1 &lt; x &lt; (p-1)/2))/</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>exchange value calculate by client</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code> - if any errors occur</dd>
</dl>
</li>
</ul>
<a name="setF-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setF</h4>
<pre>void&nbsp;setF(byte[]&nbsp;f)</pre>
<div class="block">Sets 'f' the exchange value sent by the server after receiving 'e'
 calculated by f = g^y mod p (and y (0 &lt; y &lt; q).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>f</code> - exchange value from server</dd>
</dl>
</li>
</ul>
<a name="getK--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getK</h4>
<pre>byte[]&nbsp;getK()
     throws <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></pre>
<div class="block">Returns the shared secret key calculated by K = f^x mod p.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>shared secret key</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</a></code> - if any errors occur</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DiffieHellman.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/vngx/jsch/kex/DHGroupKexAlgorithm.html" title="class in org.vngx.jsch.kex"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/vngx/jsch/kex/DiffieHellmanImpl.html" title="class in org.vngx.jsch.kex"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/vngx/jsch/kex/DiffieHellman.html" target="_top">Frames</a></li>
<li><a href="DiffieHellman.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2015. All rights reserved.</small></p>
</body>
</html>
